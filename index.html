<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Bottom Navbar UI Design with WebView</title>
    <link href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css" rel="stylesheet">
    <style>
        [x-cloak] {
            display: none;
        }
        .progress-bar-container {
            width: 100%;
            height: 4px;
            background-color: #f3f3f3;
            position: relative;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background-color: #4CAF50; /* Change to your desired color */
            position: absolute;
            left: 0;
            transition: width 0.3s ease-in-out;
        }

    </style>
    <script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js" defer></script>
    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.0.1/tailwind.min.css'>
</head>
<body>
<style>
    @import url(https://pro.fontawesome.com/releases/v5.10.0/css/all.css);
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;800&display=swap');
    body {
        font-family: 'Poppins', sans-serif;
    }


    .search-input-container {
        position: relative;
    }

    .search-icon-inside {
        position: absolute;
        top: 50%;
        right: 10px;
        transform: translateY(-50%);
        pointer-events: none;
        color: gray;
    }
    .search-input-container input {
        padding-right: 30px;
    }
    .search-input-container button {
        display: none;
    }
</style>
<div class="h-screen flex flex-col" x-data="{
    showUpgradeBar: localStorage.getItem('showUpgradeBar') !== 'false',
    showSearchBar: false,
    searchQuery: '',
    showProfilePage: false,
    isLoading: false,
    showShareModal: false,
    referralLink: '',
    showModelSelectionModal: false,
    selectedModel: 'Gemini 1.5',
    models: [
        { name: 'Gemini 1.5', provider: 'Google' },
        { name: 'Gemini 2.0', provider: 'Google' },
        { name: 'Gemini Pro', provider: 'Google' },
        { name: 'ChatGPT 3.5', provider: 'OpenAI' },
        { name: 'ChatGPT 4.0', provider: 'OpenAI' },
        { name: 'Claude Instant', provider: 'Anthropic' },
        { name: 'Claude 2', provider: 'Anthropic' },
        { name: 'Claude 3', provider: 'Anthropic' },
    ],
    iframeSrc: 'https://app.vectorshift.ai/chatbots/deployed/679744928edc24f33840453b?conversation=679de8f24dfbc23f8ad2ed9e',
    progress: 0,
    saCode: '',
    showUpdateAccountBtn: false,
     hasValidatedCode: localStorage.getItem('hasValidatedCode') === 'true',
    lastUpgradeCheck: localStorage.getItem('lastUpgradeCheck'),
    showSuccessModal: false,
    init() {
        // Check if it's been more than a month since the last upgrade check
        if (this.lastUpgradeCheck) {
              const lastCheckDate = new Date(this.lastUpgradeCheck);
              const now = new Date();
              const oneMonthAgo = new Date();
              oneMonthAgo.setMonth(now.getMonth() - 1);

              if (lastCheckDate < oneMonthAgo) {
                  this.showUpgradeBar = true;
                   localStorage.setItem('showUpgradeBar', 'true')
              } else {
                 this.showUpgradeBar = localStorage.getItem('showUpgradeBar') !== 'false';
              }
         }

    },
   updateAccount() {
          localStorage.setItem('showUpgradeBar', 'false');
           localStorage.setItem('hasValidatedCode', 'true');
           this.hasValidatedCode = true;
          this.showUpgradeBar = false;
           const now = new Date();
           localStorage.setItem('lastUpgradeCheck', now.toISOString());
          this.lastUpgradeCheck = now.toISOString();
          this.showProfilePage = false;
          this.showSuccessModal = true; // Show the modal after update
           setTimeout(() => {
                this.showSuccessModal = false;  //hide the modal after 2 second
           }, 2000);

     },
    checkSaCode() {
            this.showUpdateAccountBtn = this.saCode === 'SATA-1920';
        }
}">

    <!-- Upgrade Bar -->
    <div class="bg-pink-200 py-2 px-4 flex items-center justify-between text-sm" x-show="showUpgradeBar" x-cloak>
        <span class="text-black-700 text-xs">
          Upgrade to Pro for more features!
        </span>
        <div class="flex items-center">
           <button class="bg-green-500 text-white py-1 px-2 rounded  font-medium hover:bg-yellow-600 text-xs mr-2">
               Upgrade Now
           </button>
            <button @click="showUpgradeBar = false" class="text-gray-500 hover:text-gray-700">
                <i class="fas fa-times"></i>
            </button>
        </div>
    </div>
     <!-- Progress Bar Container -->
    <div x-show="isLoading" x-cloak class="progress-bar-container">
        <div class="progress-bar" :style="`width: ${progress}%`"></div>
    </div>

    <!-- Web Viewer -->
    <div class="flex-grow" :class="{'opacity-20 pointer-events-none': showProfilePage || isLoading || showShareModal || showModelSelectionModal || showSuccessModal}">
        <iframe
            :src="iframeSrc"
            style="width: 100%; height: 100%; border: none;"
            title="VectorShift Chatbot"
             sandbox="allow-same-origin allow-scripts allow-popups"
            x-ref="webview"
             @load="isLoading = false"
        >
        </iframe>
    </div>


    <!-- Profile Page  -->
    <div x-show="showProfilePage" x-cloak class="fixed top-0 left-0 w-full h-screen bg-gray-900 bg-opacity-50 z-50 flex items-center justify-center">
        <div class="bg-white p-6 rounded-lg shadow-xl w-11/12 sm:w-3/4 md:w-1/2 lg:w-1/3  relative">
            <div class="flex flex-col items-center justify-center">
                <div class="rounded-full bg-gray-200 w-20 h-20 flex items-center justify-center">
                    <i class="fas fa-user text-5xl text-gray-600"></i>
                </div>
                <h2 class="mt-4 text-2xl font-semibold text-gray-700">Welcome User</h2>
                <div class="mt-4 w-full">
                   <input type="text" x-model="saCode" @input="checkSaCode"  placeholder="Enter SA code" class="border border-gray-300 rounded p-2 w-full focus:outline-none focus:border-blue-500"/>
                   <button
                           x-show="showUpdateAccountBtn"
                            @click="updateAccount"
                            class="mt-4 bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded focus:outline-none w-full"
                     >Update Account Now</button>
                </div>
            </div>
            <button @click="showProfilePage = false" class="absolute top-2 right-2 text-gray-500 hover:text-gray-700">
                <i class="fas fa-times"></i>
            </button>
        </div>
    </div>

      <!-- Success Modal -->
     <div x-show="showSuccessModal" x-cloak class="fixed top-0 left-0 w-full h-screen bg-gray-900 bg-opacity-50 z-50 flex items-center justify-center">
          <div class="bg-white p-6 rounded-lg shadow-xl w-11/12 sm:w-3/4 md:w-1/2 lg:w-1/3 relative text-center">
           <h2 class="text-2xl font-semibold mb-4">Success!</h2>
           <p class="text-gray-700 mb-6">Your account is successfully upgraded! Thank you for using Samar AI.</p>
         </div>
    </div>

    <!-- Search Bar -->
    <div x-show="showSearchBar" x-cloak class="fixed top-0 left-0 w-full h-screen bg-gray-900 bg-opacity-50 z-50 flex items-center justify-center">
        <div class="bg-white p-4 rounded-lg w-11/12 sm:w-3/4 md:w-1/2 lg:w-1/3 relative">
            <div class="search-input-container">
                <input type="text" x-model="searchQuery" class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:border-blue-500" placeholder="Search Google..." @keyup.enter="if (searchQuery) window.open('https://www.google.com/search?q=' + searchQuery, '_blank')"/>
                <i class="fas fa-search search-icon-inside"></i>
                <button
                    class="p-2 rounded-full focus:outline-none hover:bg-gray-100"
                    @click="if (searchQuery) window.open('https://www.google.com/search?q=' + searchQuery, '_blank')"
                    :disabled="!searchQuery"
                    :class="{'opacity-50 cursor-not-allowed': !searchQuery, 'hover:bg-blue-200': searchQuery}"
                >
                </button>
            </div>
            <button @click="showSearchBar = false; searchQuery = ''" class="absolute top-2 right-2 text-gray-500 hover:text-gray-700">
                <i class="fas fa-times"></i>
            </button>
        </div>
    </div>

      <!-- Share Modal -->
     <div x-show="showShareModal" x-cloak class="fixed top-0 left-0 w-full h-screen bg-gray-900 bg-opacity-50 z-50 flex items-center justify-center">
          <div class="bg-white p-6 rounded-lg shadow-xl w-11/12 sm:w-3/4 md:w-1/2 lg:w-1/3 relative text-center">
           <h2 class="text-2xl font-semibold mb-4">Share & Earn!</h2>
          <p class="text-gray-700 mb-6">Invite friends and earn â‚¹50 per upgrade!</p>
           <button @click="shareOnWhatsApp()" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 focus:outline-none" >
              <i class="fab fa-whatsapp mr-2"></i> Share on WhatsApp
          </button>
          <button @click="showShareModal = false" class="absolute top-2 right-2 text-gray-500 hover:text-gray-700">
           <i class="fas fa-times"></i>
          </button>
         </div>
    </div>

    <!-- Model Selection Modal -->
    <div x-show="showModelSelectionModal" x-cloak class="fixed top-0 left-0 w-full h-screen bg-gray-900 bg-opacity-50 z-50 flex items-center justify-center">
        <div class="bg-white p-6 rounded-lg shadow-xl w-11/12 sm:w-3/4 md:w-1/2 lg:w-1/3 relative">
            <h2 class="text-2xl font-semibold mb-4 text-center">Select AI Model</h2>
            <ul>
                <template x-for="model in models" :key="model.name">
                    <li class="py-2 border-b border-gray-200 last:border-b-0 cursor-pointer hover:bg-gray-100"
                        @click="selectModel(model); showModelSelectionModal = false;">
                        <div class="flex justify-between items-center">
                           <span x-text="model.name"></span>
                           <span class="text-gray-500 text-sm" x-text="'(' + model.provider + ')'"></span>
                       </div>
                    </li>
                </template>
            </ul>
            <button @click="showModelSelectionModal = false" class="absolute top-2 right-2 text-gray-500 hover:text-gray-700">
                <i class="fas fa-times"></i>
            </button>
        </div>
    </div>

    <!-- Bottom Navbar -->
    <div class="px-2 bg-white shadow-lg rounded-2xl py-1" :class="{'opacity-20 pointer-events-none': showProfilePage || isLoading || showShareModal || showModelSelectionModal || showSuccessModal}">
        <div class="flex">
            <div class="flex-1 group">
                <a href="#"
                   class="flex items-center justify-center text-center mx-auto px-1 w-full text-gray-400 group-hover:text-white-500">
                    <span class="block px-1 py-0.5">
                        <i class="far fa-home text-xl block text-white"></i>
                        <span class="block w-3 mx-auto h-0.5 group-hover:bg-white-500 rounded-full"></span>
                    </span>
                </a>
            </div>
            <div class="flex-1 group">
                <a href="#"
                   class="flex items-center justify-center text-center mx-auto px-1 w-full text-gray-400 group-hover:text-pink-500"
                   @click.prevent="isLoading = true; setTimeout(() => { window.open('https://app.vectorshift.ai/voicebots/deployed/679a4b3cf7a15849e2359c50', '_blank'); isLoading = false; }, 1000)">
                    <span class="block px-1 py-0.5">
                        <i class="far fa-phone text-xl block fa-flip-horizontal"></i>
                        <span class="block w-3 mx-auto h-0.5 group-hover:bg-green-500 rounded-full"></span>
                    </span>
                </a>
            </div>
             <div class="flex-1 group" x-show="hasValidatedCode">
                <a href="#"
                   class="flex items-center justify-center text-center mx-auto px-1 w-full text-gray-400 group-hover:text-pink-500" @click.prevent="showModelSelectionModal = true">
                    <span class="block px-1 py-0.5">
                        <i class="fas fa-brain text-xl block"></i>
                        <span class="block w-3 mx-auto h-0.5 group-hover:bg-green-500 rounded-full"></span>
                    </span>
                </a>
            </div>
            <div class="flex-1 group">
                <a href="#"
                   class="flex items-center justify-center text-center mx-auto px-1 w-full text-gray-400 group-hover:text-pink-500" @click.prevent="showSearchBar = true">
                    <span class="block px-1 py-0.5">
                        <i class="far fa-search text-xl block"></i>
                        <span class="block w-3 mx-auto h-0.5 group-hover:bg-green-500 rounded-full"></span>
                    </span>
                </a>
            </div>
            <div class="flex-1 group">
                <a href="#"
                   class="flex items-center justify-center text-center mx-auto px-1 w-full text-gray-400 group-hover:text-pink-500" @click.prevent="showProfilePage = true">
                    <span class="block px-1 py-0.5">
                        <i class="far fa-user text-xl block"></i>
                        <span class="block w-3 mx-auto h-0.5 group-hover:bg-green-500 rounded-full"></span>
                    </span>
                </a>
            </div>
            <div class="flex-1 group">
                <a href="#"
                   class="flex items-center justify-center text-center mx-auto px-1 w-full text-gray-400 group-hover:text-pink-500" @click.prevent="showShareModal = true">
                    <span class="block px-1 py-0.5">
                        <i class="far fa-share-alt text-xl block"></i>
                        <span class="block w-3 mx-auto h-0.5 group-hover:bg-green-500 rounded-full"></span>
                    </span>
                </a>
            </div>
        </div>
    </div>
</div>
<script>
    function shareOnWhatsApp() {
        // Here, we would typically fetch the user's referral link from the backend.
        // For this example, I'm using a placeholder.
        const referralLink = "https://yourapp.com/referral?ref=USER_ID_PLACEHOLDER"; // Replace this with a function that obtains a real referral link
        const message = encodeURIComponent(`Check out this awesome app! Upgrade and I'll earn â‚¹50. ${referralLink}`);
        window.open(`https://wa.me/?text=${message}`, '_blank');
    }
   function selectModel(model) {
        this.selectedModel = model.name;
        if (model.provider === 'Google') {
            window.open('https://sites.google.com/view/aismr/gemini', '_blank');
            return; // Exit early if it's a Google model
        }
        if (model.provider === 'OpenAI') {
            window.open('https://sites.google.com/view/aismr/chatgpt', '_blank');
            return; // Exit early if it's an OpenAI model
        }
        if (model.provider === 'Anthropic') {
            window.open('https://sites.google.com/view/aismr/claude-ai', '_blank');
            return; // Exit early if it's an Anthropic model
        }

        this.isLoading = true;
        this.progress = 0;
        const interval = setInterval(() => {
            this.progress += 10;
            if (this.progress >= 100) {
                clearInterval(interval);
            }
        }, 100);

        this.iframeSrc = `http://localhost:3000/proxy?url=${encodeURIComponent('https://app.vectorshift.ai/chatbots/deployed/679744928edc24f33840453b?conversation=679de8f24dfbc23f8ad2ed9e')}`;
    }
</script>
</body>
          </html>
